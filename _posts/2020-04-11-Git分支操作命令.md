---
layout:     post   				    
title:      使用Git分支的一些经验 				
subtitle:   Git分支的使用 #副标题
date:       2020-04-12 				
author:     RecordLiu 						
header-img: img/post-bg-2015.jpg 	
catalog: true 						
tags:								
    - Git
---

## Hey

>git学习篇(4)
今天来讲讲我使用Git分支的一些经验，主要分为以下几点：
* Git分支用于平常开发
* 分支相关命令
* 使用分支常遇到的问题

## 阐述
平常开发中，一般都会对应三种环境，本地环境、测试环境、线上环境。
本地环境是指我们电脑上搭的一套环境，比如要运行PHP项目的话，我们需要有一套lam(n)p环境。平常开发都是基于本地环境开发,开发好后再把代码发布到测试环境测试，最后再发布到线上。

其中,master分支主要用于线上发布使用,dev分支用于平常的开发和测试使用。我们也可以创建多个分支，比如给某次的迭代开发创建一个分支，针对一次代码优化创建一个分支，或者针对一次Bug修复，我们可以创建个分支出来。

Git的分支创建速度非常快，它不像svn等集中式版本控制系统，每次创建需要cp代码，而是直接改变指针指向即可。比如当前指针指向master，我们基于master最近一次的提交创建个dev分支出来，其实就是创建了个指针指向dev分支而已。在切换和合并分支的时候，也都是改变指针指向，速度非常快。

## 创建分支
```
创建分支: git branch 分支名
切换分支: git checkout 分支名
查看所有分支: git brach -a
分支合并: git merge 分支名 (把分支合并到当前分支)
```
## 删除分支
随着需求的迭代，仓库中创建的分支可能会越来越多，这个时候我们需要删除一些已经merge的分支，Git提倡分支用完即删除的做法。
以下是有关删除分支的命令。
```
首先使用git branch -a查看当前所有分支。
删除本地分支：git branch -d 分支1[,分支名2,分支名3...]
删除远程分支: git push origin --delete 分支名1[,分支命2,分支名...]
```
## 缓存分支修改

有时候，我们可能会同时在几个分支上进行开发，在切换分支的时，如果当前分支有修改，这个时候功能还没有全部开发完成，你并不想马上提交到版本库的话，
我们可以使用Git提供的缓存修改的命令，把这部分修改暂时缓存起来，切换回这个分支的时候，再把它取出来。
```
缓存修改命令：git stash 
```
【注：这个命令会把提交到暂存区，就是使用git add提交之后的代码缓存起来,对未经Git管控的文件修改并不做缓存】
```
从缓存中恢复修改并删除缓存内容: git stash pop [生成的编号ID]
查看缓存列表:git stash list
```
【注:缓存列表会显示下面这样的信息,花括号中的数字代表生成的编号ID：
```
stash@{0}: WIP on master: d30e6fc 第二次提交
stash@{1}: WIP on dev: d30e6fc 第一次提交
```
】

## 最小修改提交

之前碰到过一个问题，在一次开发中，我和一个同学分别负责项目不同的模块实现，我们都基于master分支创建出一个新分支供于自己提交,也就是说在各自的分支上，我们都看不到对方的修改。本来两个分支开发的功能基本互不影响，但期间我修改到了框架的一个公共方法，这个同学也需要调用这个方法，而且他的代码需要先上线，这个时候怎么办呢？一种方式是在确认我自己代码上线无影响的情况下，和这个同学的代码一起上线，但这样不保险，并不能保证以后出现这种情况都能一起上线。另外一种方式，可以用Git提供的最小修改提交命令`git cherry-pick`。把我修改公共方法这块给单独提交一个commit,通过git cherry-pick命令给合并到这个同学的分支上，然后让他发布上线就好。
```
命令:git cherry-pick commit-id
```

## 使用心得
